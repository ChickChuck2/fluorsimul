<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="./vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simulador de Tratamento de Água - Filtro de Flúor</title>
  <script type="module" crossorigin src="./assets/index-BplR35Ga.js"></script>
  <link rel="stylesheet" crossorigin href="./assets/index-jXmHE9bT.css">
</head>

<body>
  <div id="app">
    <header>
      <h1>Planta Técnica: Remoção de Fluoreto</h1>
      <div style="display: flex; gap: 15px; align-items: center;">
        <div style="text-align: right;">
          <div id="status-text"
            style="font-size: 0.7rem; font-weight: 800; color: var(--warning-color); letter-spacing: 1px;">SISTEMA:
            AGUARDANDO</div>
          <div id="timer-text"
            style="font-family: 'JetBrains Mono', monospace; font-size: 1.1rem; color: var(--accent-color);">30:15</div>
        </div>
        <div class="stat-card" style="min-width: 140px; border-color: var(--accent-color); padding: 5px 12px;">
          <div class="stat-label">pH Online</div>
          <div id="ph-display" class="stat-value" style="color: var(--accent-color); font-size: 1.1rem;">7.00</div>
        </div>
        <div class="stat-card" style="min-width: 110px; padding: 5px 12px;">
          <div class="stat-label">Saída F-</div>
          <div id="output-ppm-main" class="stat-value" style="color: var(--text-secondary); font-size: 1.1rem;">-- ppm
          </div>
        </div>
      </div>
    </header>

    <aside class="controls">
      <section>
        <div class="stat-label" style="margin-bottom: 8px;">Parâmetros Operacionais (Etapa 5)</div>
        <div class="stat-card">
          <div class="stat-label">Vazão do Sistema</div>
          <div class="stat-value" id="flow-rate">0.0 <span style="font-size: 0.8rem; font-weight: 400;">m³/h</span>
          </div>
        </div>
        <div class="stat-card" style="margin-top: 10px;">
          <div class="stat-label">Turbidez</div>
          <div class="stat-value" id="turbidity-val">0.12 <span style="font-size: 0.8rem; font-weight: 400;">NTU</span>
          </div>
        </div>
        <div id="interlock-status" class="stat-card" style="margin-top: 10px; border-color: var(--success-color);">
          <div class="stat-label">Intertravamento</div>
          <div class="stat-value" style="font-size: 0.9rem; color: var(--success-color);">SISTEMA SEGURO</div>
        </div>
      </section>
      <div class="stat-card" style="margin-top: 10px; border-color: rgba(255, 105, 180, 0.2);">
        <div class="stat-label">Vida Útil do Filtro</div>
        <div id="filter-status" class="stat-value" style="font-size: 1rem;">EFICIENTE (100%)</div>
      </div>

      <section id="impact-section">
        <div class="stat-label" style="margin-bottom: 8px;">Impacto e Custo</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
          <div class="stat-card">
            <div class="stat-label">Volume</div>
            <div id="total-volume" class="stat-value" style="font-size: 0.9rem;">0 L</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Custo</div>
            <div id="total-cost" class="stat-value" style="font-size: 0.9rem;">R$ 0,00</div>
          </div>
        </div>
      </section>

      <section style="margin-top: auto; display: flex; flex-direction: column; gap: 10px;">
        <button id="start-btn">INICIAR SIMULAÇÃO</button>
        <button id="speed-btn" class="secondary"
          style="border-color: var(--warning-color); color: var(--warning-color);">ACELERAR (1x)</button>
        <button id="regen-btn" class="secondary"
          style="display: none; border-color: var(--spadns-pink); color: var(--spadns-pink);">REGENERAR FILTRO
          (NaOH)</button>
        <button id="reset-btn" class="secondary">REINICIAR SISTEMA</button>
      </section>

      <div id="log"
        style="font-size: 0.7rem; color: var(--text-secondary); background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; height: 120px; overflow-y: auto;">
        > Sistema pronto...
      </div>
    </aside>

    <main class="simulation-viewport">
      <!-- SVG Schematic will be manipulated via JS -->
      <svg class="schematic-svg" viewBox="0 0 1000 500">
        <defs>
          <linearGradient id="water-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop id="stop-top" offset="0%" style="stop-color:var(--water-top);stop-opacity:1" />
            <stop id="stop-bottom" offset="100%" style="stop-color:var(--water-bottom);stop-opacity:1" />
          </linearGradient>

          <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff" />
          </marker>

          <pattern id="beads-pattern" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse">
            <circle cx="5" cy="5" r="3" fill="#ffffff" opacity="0.4" />
          </pattern>
        </defs>

        <!-- Labels de Direção -->
        <g id="flow-labels">
          <rect x="20" y="215" width="80" height="20" rx="4" fill="rgba(0,0,0,0.5)" />
          <text x="60" y="230" text-anchor="middle" font-size="10" fill="#58a6ff" font-weight="bold">ENTRADA</text>
        </g>

        <!-- Pipes -->
        <g id="pipes">
          <path class="pipe" d="M 50 250 L 150 250" />
          <path class="pipe-inner" d="M 50 250 L 150 250" />

          <!-- Tubo ligando Etapa 1 ao Misturador -->
          <path class="pipe" d="M 350 250 L 410 250" />
          <path class="pipe-inner" d="M 350 250 L 410 250" />

          <!-- Misturador estático -->
          <path class="pipe" d="M 450 250 L 480 250" />
          <path class="pipe-inner" d="M 450 250 L 480 250" />

          <path class="pipe" d="M 620 250 L 760 250" />
          <path class="pipe-inner" d="M 620 250 L 760 250" />
        </g>

        <!-- Unidade de Ajuste de pH (Ácido) -->
        <g id="acid-unit" transform="translate(380, 180)">
          <rect x="20" y="0" width="60" height="20" rx="4" fill="#30363d" />
          <text x="50" y="-5" text-anchor="middle" font-size="9" fill="#f85149">Dosagem Ácido (pH 5.8)</text>
          <path d="M 50 20 L 50 60" stroke="#f85149" stroke-width="2" marker-end="url(#arrowhead)" />

          <!-- Misturador Estático -->
          <rect x="30" y="60" width="40" height="20" rx="4" fill="#161b22" stroke="#30363d" />
          <path d="M 35 70 L 65 70" stroke="#58a6ff" stroke-width="2" stroke-dasharray="2 1" />
        </g>

        <!-- Fluxo de Água Animado -->
        <path id="flow-intro" class="water-flow" d="M 50 250 L 140 250" marker-end="url(#arrowhead)" />
        <path id="flow-stage1-2" class="water-flow" d="M 350 250 L 480 250" marker-end="url(#arrowhead)" />
        <path id="flow-outro" class="water-flow" d="M 620 250 L 750 250" marker-end="url(#arrowhead)" />

        <!-- Estágio 1: Béquere de Cal (Precipitação) -->
        <g id="stage-1">
          <path class="vessel" d="M 150 150 L 150 340 Q 150 350 160 350 L 340 350 Q 350 350 350 340 L 350 150"
            fill="rgba(48, 54, 61, 0.2)" />
          <rect id="sludge-1" x="151" y="350" width="198" height="0" rx="2" fill="#8b949e" opacity="0.6"
            style="transition: height 10s linear, y 10s linear;" />
          <rect id="liquid-1" class="liquid" x="151" y="350" width="198" height="0" rx="2" />

          <!-- Ripple effect during fill -->
          <ellipse id="ripple-1" cx="250" cy="350" rx="40" ry="5" fill="none" stroke="rgba(255,255,255,0.3)"
            stroke-width="1" class="ripple" />
          <text x="250" y="110" text-anchor="middle" class="component-label" font-weight="bold">1. Precipitação
            (Cal)</text>
          <text x="250" y="125" text-anchor="middle" font-size="9" fill="var(--warning-color)">pH Setpoint: 10.5</text>

          <g transform="translate(210, 150)">
            <rect x="0" y="5" width="80" height="20" rx="2" fill="#30363d" />
            <path d="M 10 15 L 70 15" stroke="#f0f0f0" stroke-width="2" stroke-dasharray="2 2" />
            <text x="40" y="0" text-anchor="middle" font-size="9" fill="#f0f0f0">Cal Hidratada</text>
          </g>

          <!-- Partículas de Precipitação -->
          <g id="particles-group"></g>
        </g>

        <!-- Estágio 2: Coluna de Alumina (Adsorção) -->
        <g id="stage-2">
          <rect class="vessel" x="480" y="120" width="140" height="230" rx="10" fill="rgba(48, 54, 61, 0.2)" />
          <rect id="liquid-2" class="liquid" x="481" y="350" width="138" height="0" rx="2" />

          <ellipse id="ripple-2" cx="550" cy="350" rx="30" ry="4" fill="none" stroke="rgba(255,255,255,0.3)"
            stroke-width="1" class="ripple" />

          <rect x="520" y="130" width="60" height="210" rx="5" fill="url(#beads-pattern)"
            stroke="rgba(255,255,255,0.2)" />
          <text x="550" y="95" text-anchor="middle" class="component-label" font-weight="bold">2. Adsorção
            (Alumina)</text>
          <text x="550" y="110" text-anchor="middle" font-size="9" fill="#bc8cff">EBCT: 6 min | pH: 5.8</text>
        </g>

        <!-- Estágio 3: Tanque de Saída -->
        <g id="stage-3">
          <path class="vessel" d="M 760 200 L 760 340 Q 760 350 770 350 L 910 350 Q 920 350 920 340 L 920 200"
            fill="rgba(48, 54, 61, 0.2)" />
          <rect id="liquid-3" class="liquid" x="761" y="350" width="158" height="0" rx="2" />

          <ellipse id="ripple-3" cx="840" cy="350" rx="40" ry="5" fill="none" stroke="rgba(255,255,255,0.3)"
            stroke-width="1" class="ripple" />
          <text x="840" y="180" text-anchor="middle" class="component-label" font-weight="bold">Saída de Água
            Limpa</text>
        </g>

        <!-- Water Jets (Cascades) -->
        <g id="cascades">
          <path id="cascade-1" d="M 140 250 L 140 345" stroke="#58a6ff" stroke-width="4" stroke-dasharray="10 5"
            class="water-cascade" />
          <path id="cascade-2" d="M 480 250 L 480 345" stroke="#58a6ff" stroke-width="4" stroke-dasharray="10 5"
            class="water-cascade" />
          <path id="cascade-3" d="M 760 250 L 760 345" stroke="#58a6ff" stroke-width="4" stroke-dasharray="10 5"
            class="water-cascade" />
        </g>

        <!-- Teste Final -->
        <g id="indicator-group" transform="translate(950, 250)">
          <circle id="result-indicator" cx="0" cy="0" r="20" fill="rgba(48, 54, 61, 0.5)" stroke="var(--glass-border)"
            stroke-width="2" />
          <text x="0" y="40" text-anchor="middle" font-size="10" fill="var(--text-secondary)">Rosa = Limpa</text>
        </g>
      </svg>

      <!-- Gráfico de Evolução -->
      <div id="graph-container">
        <div class="stat-label" style="position: absolute; top: 10px; left: 15px;">Monitoramento de PPM</div>
        <canvas id="ppm-chart"></canvas>
      </div>
    </main>
  </div>
</body>

</html>