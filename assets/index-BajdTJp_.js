(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))E(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&E(d)}).observe(document,{childList:!0,subtree:!0});function c(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function E(i){if(i.ep)return;i.ep=!0;const s=c(i);fetch(i.href,s)}})();const h=document.getElementById("start-btn"),b=document.getElementById("speed-btn"),$=document.getElementById("reset-btn"),u=document.getElementById("status-text"),x=document.getElementById("input-ppm"),T=document.getElementById("output-ppm"),L=document.getElementById("log"),m=document.getElementById("liquid-1"),f=document.getElementById("liquid-2"),w=document.getElementById("flow-intro"),B=document.getElementById("flow-stage1-2"),D=document.getElementById("flow-outro"),p=document.getElementById("liquid-3"),N=document.getElementById("timer-text"),g=document.getElementById("result-indicator");let y=!1,t=1,a=null,r=1800;const l={STAGE_1:900*1e3,STAGE_2:720*1e3,TEST:180*1e3},o=e=>{const n=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});L.innerHTML=`<div>[${n}] ${e}</div>`+L.innerHTML},A=(e,n)=>{x.innerHTML=`${e.toFixed(1)} <span style="font-size: 0.8rem; font-weight: 400;">ppm</span>`,n!==null?(T.innerHTML=`${n.toFixed(2)} <span style="font-size: 0.8rem; font-weight: 400;">ppm</span>`,T.style.color=n<1.5?"var(--fluoride-low)":"var(--fluoride-high)"):(T.innerHTML='-- <span style="font-size: 0.8rem; font-weight: 400;">ppm</span>',T.style.color="inherit")},v=e=>{const n=Math.floor(e/60),c=Math.floor(e%60);N.innerText=`${n.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`},P=()=>{a&&clearInterval(a),a=setInterval(()=>{r-=1,r<=0&&(r=0,a&&clearInterval(a)),v(r)},1e3/t)},S=(e,n)=>{switch(u.innerText=e,n){case"RODANDO":u.style.color="var(--accent-color)";break;case"SUCESSO":u.style.color="var(--success-color)";break;case"AGUARDANDO":u.style.color="var(--warning-color)";break;default:u.style.color="var(--text-secondary)"}},M=async()=>{y||(y=!0,h.disabled=!0,S("FILTRANDO...","RODANDO"),r=1800,v(r),P(),o("Passo 1: Cal adicionada. Tempo real estimado: 15 min."),w?.classList.add("active"),m&&(m.style.transition=`height ${3e3/t}ms ease-out, y ${3e3/t}ms ease-out`,m.setAttribute("height","180"),m.setAttribute("y","170")),await O(50,10,l.STAGE_1/t),o("Flúor caiu: 50 -> 10 ppm."),o("Passo 2: Polimento com Alumina. Tempo real estimado: 12 min."),B?.classList.add("active"),f&&(f.style.transition=`height ${3e3/t}ms ease-out, y ${3e3/t}ms ease-out`,f.setAttribute("height","180"),f.setAttribute("y","170")),setTimeout(()=>{D?.classList.add("active"),p&&(p.style.transition=`height ${l.STAGE_2/t}ms linear, y ${l.STAGE_2/t}ms linear`,p.setAttribute("height","150"),p.setAttribute("y","200"))},500/t),await O(10,.82,l.STAGE_2/t),o("Água polida! Nível final: 0.82 ppm."),o("Teste de Qualidade: O Rosa indica que está pura."),await new Promise(e=>setTimeout(e,l.TEST/2/t)),g&&(g.style.transition=`fill ${2e3/t}ms`,g.style.fill="var(--spadns-pink)"),await new Promise(e=>setTimeout(e,l.TEST/2/t)),S("PRONTO","SUCESSO"),o("RESULTADO: Água Aprovada (Rosa = Limpa)."),h.disabled=!1,y=!1)},O=(e,n,c)=>new Promise(E=>{let i=e;const s=Math.max(50,100/t),d=c/s,I=(n-e)/d,R=setInterval(()=>{i+=I,(I<0?i<=n:i>=n)?(clearInterval(R),A(50,n),E(!0)):A(50,i)},s)}),G=()=>{t===1?t=10:t===10?t=100:t===100?t=1e3:t=1,b.innerText=`ACELERAR (${t}x)`,o(`Velocidade ajustada para ${t}x`),y&&P()},q=()=>{y=!1,h.disabled=!1,a&&clearInterval(a),r=1800,v(r),S("AGUARDANDO","AGUARDANDO"),A(50,null),o("Sistema reiniciado e pronto para novo ciclo."),[m,f,p].forEach(e=>{e&&(e.style.transition="none",e.setAttribute("height","0"),e.setAttribute("y","350"))}),[w,B,D].forEach(e=>e?.classList.remove("active")),g&&(g.style.fill="rgba(48, 54, 61, 0.5)")};h?.addEventListener("click",M);b?.addEventListener("click",G);$?.addEventListener("click",q);console.log("Simulation ready.");
